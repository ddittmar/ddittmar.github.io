(function(){var b=Array.prototype.slice;String.format=function(d){var c=b.call(arguments,1);return d.replace(/\{(\d+)\}/g,function(b,d){return"undefined"!==typeof c[d]?c[d]:b})};String.prototype.rot13=function(){return this.replace(/[a-zA-Z]/g,function(b){return String.fromCharCode(("Z">=b?90:122)>=(b=b.charCodeAt(0)+13)?b:b-26)})};Function.prototype.curry=function(){var d=this,c=b.call(arguments);return function(){var e=c.concat(b.call(arguments));return d.apply(this,e)}};Array.prototype.chunk=function(b){for(var c=
[],e=0,k=this.length;e<k;)c.push(this.slice(e,e+=b));return c}})();(function(b){jQuery.cachedScript=function(d,c){c=b.extend(c||{},{dataType:"script",cache:!0,url:d});return jQuery.ajax(c)}})(jQuery);
var App=function(b){function d(a,b){this.code=a;this.message=b}function c(a,f,c){var g=String.format("{0}?method={1}&api_key={2}&user_id={3}&format=json&jsoncallback=App.{4}","https://api.flickr.com/services/rest/",a,"5829e1bcf08076b3ad92b34958fe8c3b","36825657@N03",f);c&&b.each(c,function(a,b){g+="&"+a+"="+b});b.cachedScript(g)}function e(a){if("ok"!==a.stat)throw window.alert(String.format("FlickrApiException {0}: {1}",a.code,a.message)),new d(a.code,a.message);}function k(a,b){return String.format("https://farm{0}.staticflickr.com/{1}/{2}_{3}_{4}.jpg",
a.farm,a.server,a.id,a.secret,b)}function p(a){a=a.chunk(6);var f=document.createDocumentFragment();b.each(a,function(a,c){var n=b("<div>").addClass("row");b.each(c,function(a,f){var c=k(f,"q"),g=k(f,"b"),g=b("<a>").addClass("galleryImage").attr("href",g).attr("title",f.title).attr("id","picid_"+f.id).attr("data-gallery",""),c=b("<img>").attr("src",c).addClass("center-block").addClass("img-responsive").addClass("img-rounded").attr("height",150).attr("width",150).attr("style","margin-bottom: 22px;");
g.append(c);c=b("<div>").addClass("col-lg-2").addClass("col-md-2").addClass("col-sm-4").addClass("col-xs-4");c.append(g);n.append(c)});f.appendChild(n[0])});b("#gallery").empty()[0].appendChild(f)}function q(a){e(a);p(a.photos.photo)}function r(a,f){var c=b("#pager");1===a?c.find(".previous").addClass("disabled"):c.find(".previous").removeClass("disabled");a===f?c.find(".next").addClass("disabled"):c.find(".next").removeClass("disabled");c.data("page",parseInt(a,10))}function t(a){h=t;c("flickr.photos.search",
"drawGalleryWithPaging",{page:a,per_page:24,content_type:1,sort:"interestingness-desc",user_id:"36825657@N03"})}function l(a){h=l;c("flickr.people.getPhotos","drawGalleryWithPaging",{page:a,per_page:24,content_type:1})}function u(a,b){h=u.curry(a);c("flickr.photosets.getPhotos","drawAlbumWithPaging",{photoset_id:a,page:b,per_page:24})}function m(a){a.parents("ul").find("li").removeClass("active");a.parent("li").addClass("active")}var h;b(document).on("click","a#loadLatestUploadsGallery",function(a){a.preventDefault();
m(b(this));ga("send","event","loadLatestUploadsGallery","click");l(1)});b(document).on("click","a#loadInterestingnessGallery",function(a){a.preventDefault();m(b(this));ga("send","event","loadInterestingnessGallery","click");t(1)});b(document).on("click","a.loadAlbumGallery",function(a){a.preventDefault();m(b(this));a=b(this).data("photoset_id");ga("send","event","loadAlbumGallery","click","photosetid_"+a);u(a,1)});b(document).on("click","a#prevGalleryPage",function(a){a.preventDefault();a=b("#pager").data("page")-
1;ga("send","event","page","click","prev",a);h(a)});b(document).on("click","a#nextGalleryPage",function(a){a.preventDefault();b(this).parent("li").hasClass("disabled")||(a=b("#pager").data("page")+1,ga("send","event","page","click","next",a),h(a))});b(document).on("click","a.galleryImage",function(a){ga("send","event","galleryImage","click",b(this).attr("id"))});b(document).on("click",".social > a",function(a){a.preventDefault();var c=b(this).attr("href");ga("send","event","social","click",c,{hitCallback:function(){document.location=
c}})});b(document).on("click","a.btn-twitter",function(a){a.preventDefault();var c=b(this),d=c.data("url");ga("send","social","twitter","share",d,{hitCallback:function(){var a=String.format("{0}?key={1}","https://www.googleapis.com/urlshortener/v1/url","AIzaSyCnShRHKnpRuViY9tfYPHEzeGxycwN__8Y");b.ajax({url:a,type:"POST",data:JSON.stringify({longUrl:d}),processData:!1,contentType:"application/json",dataType:"json",success:function(a){a=a.id;a=String.format("{0}?url={1}&via={2}&hashtags={3}&text={4}",
c.attr("href"),encodeURIComponent(a),c.data("via"),c.data("hashtags"),c.data("text"));document.location=a}})}})});b(document).on("click","a.btn-facebook",function(a){a.preventDefault();var c=b(this),d=c.data("href");ga("send","social","facebook","share",d,{hitCallback:function(){var a=c.attr("href"),a=String.format("{0}?app_id={1}&display={2}&href={3}&redirect_uri={4}",a,c.data("app_id"),c.data("display"),encodeURIComponent(d),encodeURIComponent(c.data("redirect_uri")));document.location=a}})});return{loadLandingPageGallery:function(){c("flickr.people.getPhotos",
"drawGallery",{per_page:24,content_type:1})},drawGallery:q,onLoadGallery:function(){c("flickr.photosets.getList","drawPhotosets",{});l(1)},drawPhotosets:function(a){e(a);var c=document.createDocumentFragment();b.each(a.photosets.photoset,function(a,d){var e=b("<a>").addClass("loadAlbumGallery").attr("title",d.title._content).attr("href","#"+encodeURIComponent(d.title._content)).data("photoset_id",d.id).text(d.title._content),e=b("<li>").append(e);c.appendChild(e[0])});b("ul#albums")[0].appendChild(c)},
drawGalleryWithPaging:function(a){q(a);r(parseInt(a.photos.page,10),parseInt(a.photos.pages,10))},drawAlbumWithPaging:function(a){e(a);p(a.photoset.photo);r(parseInt(a.photoset.page,10),parseInt(a.photoset.pages,10))},clickBtnGooglePlus:function(a){a=b(a);ga("send","social","google-plus","share",a.data("url"));a=String.format("{0}?url={1}",a.attr("href"),encodeURIComponent(a.data("url")));window.open(a,"","menubar=no,toolbar=no,resizable=yes,scrollbars=yes,height=600,width=600")}}}(jQuery);
